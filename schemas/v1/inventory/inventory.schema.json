{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wrkr.dev/schemas/v1/inventory/inventory.schema.json",
  "title": "Wrkr Inventory",
  "type": "object",
  "required": ["inventory_version", "generated_at", "org", "tools", "summary"],
  "properties": {
    "inventory_version": {"type": "string"},
    "generated_at": {"type": "string", "format": "date-time"},
    "org": {"type": "string"},
    "tools": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["tool_id", "agent_id", "discovery_method", "tool_type", "org", "repos", "locations", "endpoint_class", "data_class", "autonomy_level", "risk_score", "approval_status", "lifecycle_state"],
        "properties": {
          "tool_id": {"type": "string"},
          "agent_id": {"type": "string"},
          "discovery_method": {"type": "string", "enum": ["static"]},
          "tool_type": {"type": "string"},
          "org": {"type": "string"},
          "repos": {"type": "array", "items": {"type": "string"}},
          "locations": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["repo", "location", "owner"],
              "properties": {
                "repo": {"type": "string"},
                "location": {"type": "string"},
                "owner": {"type": "string"}
              }
            }
          },
          "permissions": {"type": "array", "items": {"type": "string"}},
          "endpoint_class": {"type": "string"},
          "data_class": {"type": "string"},
          "autonomy_level": {"type": "string"},
          "risk_score": {"type": "number"},
          "approval_status": {"type": "string"},
          "lifecycle_state": {"type": "string", "enum": ["discovered", "under_review", "approved", "active", "deprecated", "revoked"]}
        }
      }
    },
    "repo_exposure_summaries": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["org", "repo", "permission_union", "data_union", "highest_autonomy", "combined_risk_score", "skill_privilege_ceiling", "skill_privilege_concentration", "skill_sprawl"],
        "properties": {
          "org": {"type": "string"},
          "repo": {"type": "string"},
          "permission_union": {"type": "array", "items": {"type": "string"}},
          "data_union": {"type": "array", "items": {"type": "string"}},
          "highest_autonomy": {"type": "string"},
          "combined_risk_score": {"type": "number"},
          "skill_privilege_ceiling": {"type": "array", "items": {"type": "string"}},
          "skill_privilege_concentration": {
            "type": "object",
            "required": ["exec_ratio", "write_ratio", "exec_write_ratio"],
            "properties": {
              "exec_ratio": {"type": "number"},
              "write_ratio": {"type": "number"},
              "exec_write_ratio": {"type": "number"}
            }
          },
          "skill_sprawl": {
            "type": "object",
            "required": ["total", "exec", "write", "read", "none"],
            "properties": {
              "total": {"type": "integer"},
              "exec": {"type": "integer"},
              "write": {"type": "integer"},
              "read": {"type": "integer"},
              "none": {"type": "integer"}
            }
          }
        }
      }
    },
    "summary": {
      "type": "object",
      "required": ["total_tools", "high_risk", "medium_risk", "low_risk"],
      "properties": {
        "total_tools": {"type": "integer"},
        "high_risk": {"type": "integer"},
        "medium_risk": {"type": "integer"},
        "low_risk": {"type": "integer"}
      }
    }
  }
}
